<view class="container">
  <!-- ç§»é™¤è§’è‰²é€‰æ‹©éƒ¨åˆ† -->
  
  <view class="interaction-content">
    <view class="current-role card">
      <text>å½“å‰èº«ä»½ï¼š{{roleNames[currentRole]}}ç«¯</text>
    </view>

    <!-- æ‚£è€…è§†å›¾ -->
    <view wx:if="{{currentRole === 'patient'}}">
      <view class="my-doctors card">
        <view class="section-title">ğŸ‘¨â€âš•ï¸ æˆ‘çš„åŒ»ç”Ÿ</view>
        <view class="doctor-list">
          <view class="doctor-item" wx:for="{{myDoctors}}" wx:key="id">
            <image src="{{item.avatar}}" class="doctor-avatar"></image>
            <view class="doctor-info">
              <text class="doctor-name">{{item.name}}</text>
              <text class="doctor-department">{{item.department}}</text>
              <text class="doctor-hospital">{{item.hospital}}</text>
            </view>
            <button class="contact-btn" bindtap="contactDoctor" data-id="{{item.id}}">è”ç³»</button>
          </view>
        </view>
      </view>

      <view class="medication-records card">
        <view class="section-title">ğŸ“Š æœè¯è®°å½•å…±äº«</view>
        <view class="share-settings">
          <text>å‘åŒ»ç”Ÿå…±äº«æˆ‘çš„æœè¯è®°å½•</text>
          <switch checked="{{shareWithDoctors}}" bindchange="toggleShareWithDoctors" />
        </view>
        <view class="share-settings">
          <text>å‘å®¶å±å…±äº«æˆ‘çš„æœè¯è®°å½•</text>
          <switch checked="{{shareWithFamily}}" bindchange="toggleShareWithFamily" />
        </view>
      </view>

      <view class="online-experts card">
        <view class="section-title">ğŸ‘¨â€âš•ï¸ åœ¨çº¿ä¸“å®¶</view>
        <view class="experts-list">
          <view class="expert-item" wx:for="{{onlineExperts}}" wx:key="id">
            <image src="{{item.avatar}}" class="expert-avatar"></image>
            <view class="expert-info">
              <text class="expert-name">{{item.name}}</text>
              <text class="expert-department">{{item.department}}</text>
            </view>
            <view class="expert-status {{item.online ? 'online' : 'offline'}}">
              {{item.online ? 'åœ¨çº¿' : 'ç¦»çº¿'}}
            </view>
            <button class="contact-btn" wx:if="{{item.online}}" bindtap="contactExpert" data-id="{{item.id}}">å’¨è¯¢</button>
          </view>
        </view>
      </view>
    </view>

    <!-- åŒ»ç”Ÿè§†å›¾ -->
    <view wx:if="{{currentRole === 'doctor'}}">
      <view class="my-patients card">
        <view class="section-title">ğŸ‘¥ æˆ‘çš„æ‚£è€…</view>
        <view class="patient-list">
          <view class="patient-item" wx:for="{{myPatients}}" wx:key="id" bindtap="viewPatientDetail" data-id="{{item.id}}">
            <image src="{{item.avatar}}" class="patient-avatar"></image>
            <view class="patient-info">
              <text class="patient-name">{{item.name}}</text>
              <text class="patient-adherence">ä¾ä»ç‡ï¼š{{item.adherenceRate}}%</text>
              <text class="patient-lastVisit">ä¸Šæ¬¡å¤è¯Šï¼š{{item.lastVisit}}</text>
            </view>
            <view class="patient-status {{item.needAttention ? 'warning' : 'normal'}}">
              {{item.needAttention ? 'éœ€å…³æ³¨' : 'è‰¯å¥½'}}
            </view>
          </view>
        </view>
      </view>

      <view class="patient-alerts card" wx:if="{{patientAlerts.length > 0}}">
        <view class="section-title text-warning">âš ï¸ æ‚£è€…é¢„è­¦</view>
        <view class="alert-item" wx:for="{{patientAlerts}}" wx:key="patientId">
          <text>{{item.patientName}} - {{item.alertType}}</text>
          <text class="alert-time">{{item.time}}</text>
        </view>
      </view>
    </view>

    <!-- å®¶å±è§†å›¾ -->
    <view wx:if="{{currentRole === 'family'}}">
      <view class="family-members card">
        <view class="section-title">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ç…§æŠ¤æˆå‘˜</view>
        <view class="member-list">
          <view class="member-item" wx:for="{{familyMembers}}" wx:key="id">
            <image src="{{item.avatar}}" class="member-avatar"></image>
            <view class="member-info">
              <text class="member-name">{{item.name}}</text>
              <text class="member-relation">{{item.relation}}</text>
              <text class="member-status">ä»Šæ—¥æœè¯ï¼š{{item.todayMedication}}</text>
            </view>
            <button class="remind-btn" bindtap="sendReminder" data-id="{{item.id}}">æé†’</button>
          </view>
        </view>
      </view>

      <view class="family-chat card">
        <view class="section-title">ğŸ’¬ å®¶åº­èŠå¤©å®¤</view>
        <view class="chat-messages">
          <view class="message {{message.sender === 'me' ? 'own' : 'other'}}" 
                wx:for="{{familyChat}}" wx:key="id">
            <text class="message-content">{{message.content}}</text>
            <text class="message-time">{{message.time}}</text>
          </view>
        </view>
        <view class="chat-input">
          <input placeholder="è¾“å…¥æ¶ˆæ¯..." bindinput="onChatInput" value="{{chatMessage}}" />
          <button class="send-btn" bindtap="sendMessage">å‘é€</button>
        </view>
      </view>
    </view>

    <!-- é€šç”¨æ¶ˆæ¯ä¸­å¿ƒ -->
    <view class="message-center card">
      <view class="section-title">ğŸ“¨ æ¶ˆæ¯ä¸­å¿ƒ</view>
      <view class="message-list">
        <view class="message-item" wx:for="{{messages}}" wx:key="id" bindtap="viewMessage" data-id="{{item.id}}">
          <view class="message-header">
            <text class="message-sender">{{item.sender}}</text>
            <text class="message-time">{{item.time}}</text>
          </view>
          <text class="message-preview">{{item.preview}}</text>
          <text class="message-status {{item.unread ? 'unread' : 'read'}}">{{item.unread ? 'æœªè¯»' : 'å·²è¯»'}}</text>
        </view>
      </view>
    </view>
  </view>
</view>